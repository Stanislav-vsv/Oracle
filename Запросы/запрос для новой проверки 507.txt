

--ПРОВЕРКА 507

INSERT INTO dqmon.DQ_DETAILJOURNAL_TRAN
(
column_name, 
COLUMN_UK1, 
DEFAULTST_FLAG, 
DESCRIPTION, 
DQ_CONTROL_UK, 
DQ_LEVEL_UK, 
ERROR_FLAG, 
RESULT_NUM1, 
RESULT_NUM2, 
RESULT_NUM3,  
VALUE_DATE   
)
SELECT
'ALL', 
0, 
'N', 
CASE WHEN F_STR1 = 'Ошибка' THEN  'Ошибка' ELSE 'ok' END, 
57, 
5, 
CASE WHEN ERROR_FLAG = 0 THEN 'N' ELSE 'Y' END, 
F_NUM1, 
F_NUM2, 
F_NUM3, 
F_STR2 
FROM  MONITORING.SVER_PROV_OST_CORE_507@DW_ST_PROD;





-- второй вариант с процедурой


BEGIN

MONITORING.P_NEWDQ_507@ DW_ST_PROD;

INSERT INTO dqmon.DQ_DETAILJOURNAL_TRAN
(
COLUMN_NAME, 
COLUMN_UK1, 
DEFAULTST_FLAG, 
DESCRIPTION, 
DQ_CONTROL_UK, 
DQ_LEVEL_UK, 
ERROR_FLAG, 
RESULT_NUM1, 
RESULT_NUM2, 
RESULT_NUM3,  
VALUE_DATE   
)
SELECT 
COLUMN_NAME, 
COLUMN_UK1, 
DEFAULTST_FLAG, 
DESCRIPTION, 
DQ_CONTROL_UK, 
DQ_LEVEL_UK, 
ERROR_FLAG, 
RESULT_NUM1, 
RESULT_NUM2, 
RESULT_NUM3,  
VALUE_DATE   
FROM MONITORING.NEW_DQ@DW_ST_PROD;

COMMIT;
END;
